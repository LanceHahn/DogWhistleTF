When West Virginia Sen. Joe Manchin, the U.S. Senate’s swing vote, announced last December that he wouldn’t support the sprawling, multi-trillion dollar Build Back Better Act that had been stuffed with Democrats’ dreamiest legislative ambitions, that didn’t mean that all of it had to be dropped for good.There just had to be a change in tactics.Instead of trying to isolate and pressure Manchin into signing off on legislation he didn’t want—a tactic that led the party directly into a brick wall—Democrats had to give Manchin the pen and paper, and work from there.The key question on whether Democrats’ could finish such a bill, though, wasn’t so much about what Manchin was willing to vote for. As a top Democratic aide told me earlier this year, the question was: When would he be willing to vote?The answer turned out to be: In August, about three months before the midterms, just when Manchin’s colleagues were desperate enough to pass anything.On Sunday, after more than a year of crafting different versions of one mega-bill that could bypass the filibuster, Manchin and every other Senate Democrat passed the Inflation Reduction Act. The vote was 51-50 along party lines, with Vice President Harris casting the tie-breaking vote. It now moves off to the House for a vote later in the week and, barring any problems there, to the president’s desk.The bill is way, way narrower than Democrats’ earlier vision—and too small to affect inflation meaningfully one way or another. But beneath the bill’s poll-tested title is a permanent tax policy to promote broad clean energy programs for the first time, ever. It will allow Medicare to negotiate the costs of certain prescription drugs for the first time, a 20-year progressive goal; and it will extend a recent improvement of the Affordable Care Act’s subsidies for another three years. It will institute a minimum tax for large corporations, and slap an excise tax on corporate stock buybacks. Yes, the bill shed more and more priorities as it went along—right up through the final amendment vote on the Senate floor before it passed. But it’s still a significant piece of legislation, and one that many had given up on ever seeing.Manchin decided a couple of months ago that he was ready to reopen talks with Majority Leader Chuck Schumer, with whom he negotiated the bulk of the bill. They kept their talks quite private, which is usually a good sign that things were getting serious.Still, the centerpiece of the bill—$300+ billion in clean energy incentives, which would make it the biggest climate package ever passed out of the Senate—nearly didn’t make it. In mid-July, Manchin went to Schumer and told him he still wouldn’t be ready to vote for that, or the corporate tax piece, until after the August recess when he’d seen another inflation report. Schumer’s office, in Manchin’s words, “turned the dogs loose” on him, telling reporters that Manchin was once again going wobbly and refusing to commit.What no one knew, though, was that Manchin and Schumer patched things up a few days later and kept negotiating. In late July, they shocked Washington by announcing they’d reached a deal including the climate package.Democrats had operated on the assumption that once they got Manchin’s vote, the rest would fall into place. They were correct. A good week or so was spent fretting about Arizona Sen. Kyrsten Sinema, Democrats’ other troublesome centrist who was peeved not to have been looped into the Manchin-Schumer negotiations. But Sinema wanted a climate bill, and would have committed herself to certain primary doom next cycle had she actually gone out and killed the thing. She negotiated a few changes to the bill—some of them good for the public; some of them good for hedge fund managers—and got on board.Progressives, meanwhile, knew that they had little choice this late in the game but to swallow what Schumer and Manchin had cooked up. That didn’t make it easy. So many progressive priorities—programs for child care, housing, expanding Medicare and Medicaid, making permanent a jumbo-sized Child Tax Credit, paid family and medical leave—had been shed along the way. On Saturday, news came that the Senate parliamentarian would slim the bill down even further, finding that drug rebates for private insurance plans didn’t meet reconciliation requirements. A cap on insulin costs for those with private insurance plans was struck from the bill on Sunday for similar reasons, with Republicans forcing the vote to remove it.It fell on Vermont Sen. Bernie Sanders, then, to perform a vigil of sorts for the progressive programs fallen by the wayside.To pass a reconciliation bill, the Senate majority doesn’t need to worry about breaking a filibuster. It does, however, need to go through a what’s known informally as “vote-o-rama,” an open-ended series of amendment votes that lasts as long as the minority party can stay awake to cause trouble. Most Democrats adopted a strategy of voting against each and every amendment, however intriguing some of those offerings might have been, to “protect the integrity of the bill.” Any amendment that was successfully adopted could splinter the fragile, painstakingly negotiated 50-vote Democratic coalition for the Inflation Reduction Act.Sanders, to the chagrin of many of his Democratic colleagues, didn’t play along. He offered several amendments to restore elements to the bill that most Democrats liked, but which Manchin (and potentially Sinema) wouldn’t support—to extend the Child Tax Credit, to raise the corporate tax rate to 28 percent, to add vision, dental and hearing benefits to Medicare, and so on. On several of Sanders’ amendments, he was the only member of the chamber who voted for them. His most successful amendment got three votes.“Senator Sanders is right,” Ohio Sen. Sherrod Brown said during the debate over Sanders’ Child Tax Credit amendment. “But I ask my colleagues to vote no because this will bring the bill down.” (“Come on, Bernie,” he then said to himself while his mic was still hot.)Most Democrats, progressives and moderates, were united in their resolve to shoot down Republican amendments. But near the end of the onslaught, Republicans finally made some traction with Sinema (and a few other moderate or vulnerable senators), who was worried that the corporate minimum tax would unfairly hit subsidiaries of private equity firms. Seven Democrats joined all Republicans on an amendment carving out those firms from the tax, and then Democrats passed a superseding amendment filling the revenue hole with another provision.Once that fire was put out, members were ready to bounce. It had been 16 hours of voting through the night. Coffee and 10-minute naps in the cloakroom were no longer getting it done. It was time for Democrats to pass what was left of their original, dream vision, the programs they’d spent more than a decade designing since they last had unified control of Congress. That vision had taken a bruising over the previous year. But Democrats didn’t come out empty handed.As the vote for final passage was wrapping up, Republicans rushed out of the chamber to catch their flights home or pass out. Democrats stayed behind a little longer, applauded, and gloated to nearby reporters.Joe Manchin got plenty of handshakes and slaps on the back.